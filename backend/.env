
# ===============================
# Server
# ===============================
NODE_ENV=production
PORT=4333
HOST=0.0.0.0

# Serve built SPA directly from Express
FRONTEND_DIR=/var/www/foodrequest/frontend/dist


# Local timezone for all scheduling (reminders, cutoff)
TZ=Asia/Phnom_Penh
LOG_LEVEL=info


# ===============================
# Database
# ===============================
# Keep your URI here. If it's a shared screenshot anywhere, rotate the Mongo user password too.
MONGO_URI=mongodb+srv://vuthsakmakmol123:zzA1nIbImE7Da0CD@cluster0.nhk2s.mongodb.net/foodrequest?retryWrites=true&w=majority

# ===============================
# Security
# ===============================
# Generate a strong secret (see step 2). No quotes.
JWT_SECRET=REPLACE_WITH_LONG_RANDOM_STRING

# Comma-separated exact origins (protocol + host [+ port]), no trailing slash.
# Keep your IP and local dev; add your HTTPS domain later.
CORS_ORIGINS=http://178.128.48.101,http://localhost:5173

# ===============================
# Initial Admin Seed (one-time)
# Run: npm run seed:admin  → then DELETE these three lines.
# ===============================
ADMIN_LOGIN=admin
ADMIN_NAME=Kitchen Admin
ADMIN_PASSWORD=Passw0rd!

# ===============================
# Telegram
# ===============================
# Rotate the token in BotFather first, then paste here.
TELEGRAM_BOT_TOKEN=8083027559:AAFPy1JCSZvKGmNhDABkm9JgQqnsMzhFKuM
# Multiple IDs allowed, comma-separated. Your personal chat ID is positive; groups are negative.
TELEGRAM_ADMIN_CHAT_IDS=7163451169,-4848771575


# ===============================
# Recurring Engine / Scheduling
# ===============================
# Runner mode:
# - timer  → in-process setInterval/daily timers (no Redis required)
# - redis  → BullMQ recurring jobs (requires REDIS_URL)
QUEUE_DRIVER=timer

# If you switch to BullMQ later:
REDIS_URL=redis://127.0.0.1:6379

# ===== Recurring rules =====
MAX_RECURRING_DAYS=30
DEFAULT_MORNING_ALERT=07:00
RECURRING_TICK_MS=60000        # check every 60s
# Sundays are auto-holidays. Add extra national days here:
HOLIDAYS=2025-01-01,2025-04-14,2025-04-15,2025-04-16

# Kitchen timing rules (local time, TZ above)
KITCHEN_CUTOFF=07:30             # last time to edit/skip same-day
DEFAULT_MORNING_ALERT=07:00      # reminder for orders without explicit time
REMINDER_OFFSET_MIN=60           # minutes before eatTimeStart

# Cron patterns (used only when QUEUE_DRIVER=redis)
RUNNER_CRON=0 6 * * *            # 06:00 — create today’s occurrences
DIGEST_CRON=10 6 * * *           # 06:10 — admin digest (optional)
REMINDER_TICK_EVERY_MS=300000    # 5 minutes — reminder sweep

# Catch-up if server was down
CATCHUP_LOOKBACK_MIN=90

# ===============================
# Realtime / Sockets
# ===============================
SOCKET_ALLOWED_ORIGINS=http://178.128.48.101,http://localhost:5173

# ===============================
# Build / Node options (optional)
# ===============================
# NODE_OPTIONS=--max-old-space-size=1024